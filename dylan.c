#include "dylan.h"

#ifdef OLED_ENABLE

// 32x32px sprite (128 bytes)
static const uint8_t PROGMEM pet_sprite[128] = {
    // 'New Piskel', 32x32px
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x1f, 0x00, 0x00, 0xf8, 0x13, 0x00, 0x00, 0xc8, 0x11, 0x00, 0x00, 0x88, 0x19, 0x1f, 0xf8, 0x98,
    0x1f, 0xe0, 0x07, 0xf8, 0x02, 0x00, 0x00, 0x80, 0x02, 0x00, 0x00, 0xc0, 0x02, 0x3c, 0x3c, 0x60,
    0x06, 0x00, 0x00, 0x20, 0x04, 0x00, 0x00, 0x20, 0x04, 0x00, 0x00, 0x20, 0x04, 0x00, 0x00, 0x20,
    0x04, 0x3f, 0xfc, 0x20, 0x06, 0x00, 0x00, 0xe0, 0x02, 0x00, 0x00, 0x80, 0x03, 0x00, 0x00, 0x80,
    0x01, 0x00, 0x00, 0x80, 0x01, 0x00, 0x00, 0xc0, 0x01, 0x00, 0x00, 0x7e, 0x01, 0xfe, 0x3f, 0xc1,
    0x01, 0xfe, 0x3f, 0xc0, 0x01, 0x06, 0x30, 0x00, 0x01, 0x06, 0x30, 0x00, 0x01, 0x00, 0x00, 0x00,
    0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0xc0, 0x00, 0x00, 0x00, 0x7f, 0xff, 0xff
};

// If the image is rotated, try OLED_ROTATION_90 / _180 / _270
oled_rotation_t oled_init_user(oled_rotation_t rotation) {
    return OLED_ROTATION_0;
}

bool oled_task_user(void) {
    oled_clear();

    // 128x32 screen, 32x32 sprite => center X at (128-32)/2 = 48px
    // 48px / 8px-per-char-cell = cursor column 6
    oled_set_cursor(6, 0);

    // Pointer cast required by QMK OLED API
    oled_write_raw_P((const char *)pet_sprite, sizeof(pet_sprite));

    return false;
}
#endif

bool encoder_update_user(uint8_t index, bool clockwise) {
    if (index == 0) {
        tap_code(clockwise ? KC_VOLU : KC_VOLD);
    }
    return true;
}


